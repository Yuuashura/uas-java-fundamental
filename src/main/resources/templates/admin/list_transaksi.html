<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Admin - Dekrit Pesanan</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <style>
        body { font-family: 'Quicksand', sans-serif; background: #1e1535 url('https://raw.githubusercontent.com/Yuuashura/assets/refs/heads/main/1362745.png') fixed center/cover; color: #fff; min-height: 100vh; }
        body::after { content: ''; position: fixed; inset: 0; background: rgba(10, 5, 20, 0.85); z-index: -1; }
        
        .sidebar { background: rgba(20, 15, 35, 0.95); border-right: 1px solid rgba(162, 155, 254, 0.2); min-height: 100vh; }
        .nav-link { color: #aaa; margin-bottom: 5px; border-radius: 10px; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { background: rgba(162, 155, 254, 0.15); color: #a29bfe; }
        .admin-title { font-family: 'Cinzel', serif; color: #fdcb6e; letter-spacing: 2px; }
        .glass-panel { background: rgba(40, 30, 70, 0.7); border: 1px solid rgba(162, 155, 254, 0.2); border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }

        /* === ANIMASI === */
        tbody tr { opacity: 0; animation: slideIn 0.5s ease-out forwards; transition: 0.2s; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        tbody tr:nth-child(1) { animation-delay: 0.1s; } tbody tr:nth-child(2) { animation-delay: 0.15s; } tbody tr:nth-child(3) { animation-delay: 0.2s; } 
        tbody tr:nth-child(4) { animation-delay: 0.25s; } tbody tr:nth-child(5) { animation-delay: 0.3s; }
        
        .table { --bs-table-bg: transparent; --bs-table-color: #eee; border-color: rgba(255,255,255,0.1); }
        .table-hover tbody tr:hover { background-color: rgba(162, 155, 254, 0.25) !important; transform: scale(1.01); z-index: 10; position: relative; }
        .table-hover tbody tr:hover > * { color: #fff !important; }
        
        th { font-family: 'Cinzel', serif; color: #fdcb6e !important; }
        .admin-thumb { width: 40px; height: 40px; object-fit: cover; border-radius: 6px; border: 1px solid #a29bfe; }
        .badge-status { min-width: 95px; padding: 8px; backdrop-filter: blur(5px); }
        .bg-pending { background: rgba(255, 193, 7, 0.15); color: #ffca2c; border: 1px solid #ffc107; }
        .bg-paid { background: rgba(13, 202, 240, 0.15); color: #0dcaf0; border: 1px solid #0dcaf0; }
        .bg-sent { background: rgba(13, 110, 253, 0.15); color: #6ea8fe; border: 1px solid #0d6efd; }
        .bg-done { background: rgba(32, 201, 151, 0.15); color: #20c997; border: 1px solid #20c997; }
        .bg-cancel { background: rgba(220, 53, 69, 0.15); color: #ea868f; border: 1px solid #dc3545; }
    </style>
</head>
<body>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2 sidebar p-4 d-none d-md-block">
            <h5 class="admin-title mb-4"><i class="bi bi-shield-fill me-2"></i>SHOGUNATE</h5>
            <nav class="nav flex-column gap-2">
                <a class="nav-link" href="/admin/produk"><i class="bi bi-box-seam me-2"></i> Inventaris</a>
                <a class="nav-link active" href="/admin/transaksi"><i class="bi bi-scroll me-2"></i> Dekrit Pesanan</a>
                <a class="nav-link" href="/admin/users"><i class="bi bi-people me-2"></i> Penduduk</a>
                <a class="nav-link" href="/admin/provinsi"><i class="bi bi-map me-2"></i> Wilayah</a>
                <hr class="border-secondary">
                <a class="nav-link text-danger" href="/logout"><i class="bi bi-box-arrow-right me-2"></i> Undur Diri</a>
            </nav>
        </div>
        <div class="col-md-10 p-4">
            <h3 class="admin-title mb-4">Daftar Dekrit</h3>
            <div class="glass-panel p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead>
                            <tr><th class="ps-4">ID</th><th>Artefak</th><th>Traveler</th><th>Waktu</th><th>Total</th><th>Status</th><th class="text-end pe-4">Aksi</th></tr>
                        </thead>
                        <tbody>
                            <tr th:each="trx : ${listTransaksi}">
                                <td class="ps-4 text-white-50 fw-bold" th:text="'#' + ${trx.idTransaksi}">#1</td>
                                <td>
                                    <div class="d-flex gap-1">
                                        <div th:each="detail : ${trx.details}"><img th:if="${detail.produk.gambarProduct != null}" th:src="'data:image/jpeg;base64,' + ${detail.produk.gambarProduct}" class="admin-thumb"></div>
                                    </div>
                                </td>
                                <td><div class="fw-bold text-light" th:text="${trx.user.namaLengkap}">Nama</div></td>
                                <td class="small text-white-50" th:text="${#temporals.format(trx.tanggalTransaksi, 'dd/MM HH:mm')}">12/12</td>
                                <td class="fw-bold text-warning" th:text="'Rp ' + ${trx.grandTotal}">Rp 0</td>
                                <td><span th:classappend="'badge badge-status ' + (${trx.status.name() == 'PENDING'} ? 'bg-pending' : (${trx.status.name() == 'PAID'} ? 'bg-paid' : (${trx.status.name() == 'SENT'} ? 'bg-sent' : (${trx.status.name() == 'DONE'} ? 'bg-done' : 'bg-cancel'))))" th:text="${trx.status}">STATUS</span></td>
                                <td class="text-end pe-4">
                                    <div th:if="${trx.status.name() == 'PENDING'}">
                                        <a th:href="@{/admin/transaksi/status/{id}?status=PAID(id=${trx.idTransaksi})}" class="btn btn-sm btn-outline-success me-1"><i class="bi bi-check-lg"></i></a>
                                        <a th:href="@{/admin/transaksi/status/{id}?status=CANCEL(id=${trx.idTransaksi})}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Batalkan?')"><i class="bi bi-x-lg"></i></a>
                                    </div>
                                    <div th:if="${trx.status.name() == 'PAID'}"><a th:href="@{/admin/transaksi/status/{id}?status=SENT(id=${trx.idTransaksi})}" class="btn btn-sm btn-primary fw-bold px-3">KIRIM</a></div>
                                    <span th:if="${trx.status.name() == 'DONE'}" class="text-success small"><i class="bi bi-check-all"></i></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>